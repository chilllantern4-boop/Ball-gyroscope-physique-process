<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Plasma Ball Tilt Game</title>
<style>
html, body { margin:0; padding:0; overflow:hidden; height:100%; background:black;}
canvas { display:block; width:100vw; height:100vh; }
#startBtn {
  position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
  background:orange; border:none; padding:15px 30px; font-size:18px;
  color:white; border-radius:10px; cursor:pointer; box-shadow:0 0 15px #ff6600;
}
#log { position:absolute; bottom:10px; left:10px; color:white; font-size:12px; }
</style>
</head>
<body>
<canvas id="game"></canvas>
<button id="startBtn">Start Game</button>
<div id="log"></div>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let ball = { x: canvas.width/2, y: canvas.height/2, r:35, vx:0, vy:0 };
let ax=0, ay=0, started=false, friction=0.985;
const logEl = document.getElementById('log');

function drawBall() {
  const g = ctx.createRadialGradient(ball.x, ball.y, 10, ball.x, ball.y, 90);
  g.addColorStop(0,'#ffffaa'); g.addColorStop(0.3,'#ff6600'); g.addColorStop(1,'#000000');
  ctx.fillStyle = g;
  ctx.beginPath();
  ctx.arc(ball.x, ball.y, ball.r, 0, Math.PI*2);
  ctx.fill();
}

function updateBall() {
  ball.vx += ax;
  ball.vy += ay;
  ball.vx *= friction; ball.vy *= friction;
  ball.x += ball.vx; ball.y += ball.vy;

  if(ball.x-ball.r<0){ ball.x=ball.r; ball.vx*=-0.8; }
  if(ball.x+ball.r>canvas.width){ ball.x=canvas.width-ball.r; ball.vx*=-0.8; }
  if(ball.y-ball.r<0){ ball.y=ball.r; ball.vy*=-0.8; }
  if(ball.y+ball.r>canvas.height){ ball.y=canvas.height-ball.r; ball.vy*=-0.8; }
}

function loop() { if(!started) return; ctx.clearRect(0,0,canvas.width,canvas.height); updateBall(); drawBall(); requestAnimationFrame(loop); }

document.getElementById('startBtn').addEventListener('click', async () => {
  // Chrome/iOS requires permission
  if (typeof DeviceOrientationEvent !== 'undefined' && typeof DeviceOrientationEvent.requestPermission === 'function') {
    try {
      const res = await DeviceOrientationEvent.requestPermission();
      if(res === 'granted') {
        window.addEventListener('deviceorientation', handleTilt);
        start();
      } else alert('You must allow motion access!');
    } catch(e){ alert('Error: ' + e); }
  } else {
    window.addEventListener('deviceorientation', handleTilt);
    start();
  }
});

function handleTilt(e) {
  // gamma = left/right, beta = forward/back
  ax = e.gamma/40;
  ay = e.beta/40;
  logEl.textContent = `Gamma:${e.gamma?.toFixed(1)}, Beta:${e.beta?.toFixed(1)}, ax:${ax.toFixed(2)}, ay:${ay.toFixed(2)}`;
}

function start() {
  started = true;
  document.getElementById('startBtn').style.display='none';
  loop();
}
</script>
</body>
</html>
  g.addColorStop(0.3,'#ff6600');
  g.addColorStop(1,'#000000');
  ctx.beginPath();
  ctx.fillStyle=g;
  ctx.arc(ball.x,ball.y,ball.r,0,Math.PI*2);
  ctx.fill();
}

function updateBall(){
  ball.vx+=ax;
  ball.vy+=ay;
  ball.vx*=friction;
  ball.vy*=friction;
  ball.x+=ball.vx;
  ball.y+=ball.vy;

  if(ball.x-ball.r<0){ball.x=ball.r;ball.vx*=-0.8;}
  if(ball.x+ball.r>canvas.width){ball.x=canvas.width-ball.r;ball.vx*=-0.8;}
  if(ball.y-ball.r<0){ball.y=ball.r;ball.vy*=-0.8;}
  if(ball.y+ball.r>canvas.height){ball.y=canvas.height-ball.r;ball.vy*=-0.8;}
}

function loop(){
  if(!started)return;
  ctx.clearRect(0,0,canvas.width,canvas.height);
  updateBall();
  drawBall();
  requestAnimationFrame(loop);
}

document.getElementById('startBtn').addEventListener('click',async()=>{
  if(typeof DeviceOrientationEvent!=='undefined'&&typeof DeviceOrientationEvent.requestPermission==='function'){
    try{
      const res=await DeviceOrientationEvent.requestPermission();
      if(res==='granted'){
        window.addEventListener('deviceorientation',handleTilt);
        start();
      }else alert('Please allow motion permission to play.');
    }catch(e){alert('Error: '+e);}
  }else{
    window.addEventListener('deviceorientation',handleTilt);
    start();
  }
});

function handleTilt(e){
  // Tilt values: left/right (gamma), forward/back (beta)
  ax=e.gamma/40; // smaller divisor → more sensitive
  ay=e.beta/40;
  logEl.textContent=`Gamma: ${e.gamma.toFixed(1)}, Beta: ${e.beta.toFixed(1)}, ax: ${ax.toFixed(2)}, ay: ${ay.toFixed(2)}`;
}

function start(){
  started=true;
  document.getElementById('startBtn').style.display='none';
  loop();
}
</script>
</body>
</html>
    color:#000;
    font-weight:bold;
    cursor:pointer;
    margin:6px;
  }
  .btn:active{opacity:0.7;}
</style>
</head>
<body>
  <canvas id="canvas"></canvas>
  <div>
    <button id="addBall" class="btn">Add Ball</button>
    <button id="clear" class="btn">Clear</button>
    <button id="gyroBtn" class="btn">Enable Gyroscope</button>
  </div>
<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
let DPR = window.devicePixelRatio || 1;

function resize(){
  canvas.width = canvas.clientWidth * DPR;
  canvas.height = canvas.clientHeight * DPR;
  ctx.setTransform(DPR,0,0,DPR,0,0);
}
resize();
window.addEventListener('resize', resize);

const balls = [];
let gravity = {x:0,y:0.5};

class Ball{
  constructor(x,y,r,color){
    this.x=x; this.y=y;
    this.vx=0; this.vy=0;
    this.r=r;
    this.color=color;
  }
  update(){
    this.vx += gravity.x;
    this.vy += gravity.y;
    this.vx *= 0.99;
    this.vy *= 0.99;
    this.x += this.vx;
    this.y += this.vy;
    if(this.x - this.r < 0){this.x=this.r;this.vx*=-0.8;}
    if(this.x + this.r > canvas.clientWidth){this.x=canvas.clientWidth-this.r;this.vx*=-0.8;}
    if(this.y - this.r < 0){this.y=this.r;this.vy*=-0.8;}
    if(this.y + this.r > canvas.clientHeight){this.y=canvas.clientHeight-this.r;this.vy*=-0.8;}
  }
  draw(){
    const g=ctx.createRadialGradient(this.x,this.y,this.r*0.3,this.x,this.y,this.r);
    g.addColorStop(0,"#fff");
    g.addColorStop(1,this.color);
    ctx.fillStyle=g;
    ctx.beginPath();
    ctx.arc(this.x,this.y,this.r,0,Math.PI*2);
    ctx.fill();
  }
}

function spawnBall(){
  const r=Math.random()*15+10;
  const x=Math.random()*(canvas.clientWidth-2*r)+r;
  const y=Math.random()*(canvas.clientHeight-2*r)+r;
  const color=['#ff6600','#ffcc00','#ff3300'][Math.floor(Math.random()*3)];
  balls.push(new Ball(x,y,r,color));
}

function loop(){
  ctx.fillStyle="rgba(0,0,0,0.3)";
  ctx.fillRect(0,0,canvas.clientWidth,canvas.clientHeight);
  balls.forEach(b=>{b.update();b.draw();});
  requestAnimationFrame(loop);
}
loop();

document.getElementById('addBall').onclick=()=>{for(let i=0;i<5;i++)spawnBall();};
document.getElementById('clear').onclick=()=>{balls.length=0;};

// ---------- Gyroscope ----------
const gyroBtn=document.getElementById('gyroBtn');
let gyroActive=false;

async function enableGyro(){
  try{
    if (typeof DeviceMotionEvent !== "undefined" &&
        typeof DeviceMotionEvent.requestPermission === "function") {
      // Chrome iOS / Android requires user gesture
      const permission = await DeviceMotionEvent.requestPermission();
      if(permission === "granted"){
        window.addEventListener("deviceorientation", handleOrientation);
        gyroBtn.textContent="Disable Gyroscope";
        gyroActive=true;
      } else {
        alert("Permission denied for motion sensors.");
      }
    } else {
      // For browsers that don’t need permission
      window.addEventListener("deviceorientation", handleOrientation);
      gyroBtn.textContent="Disable Gyroscope";
      gyroActive=true;
    }
  }catch(e){
    alert("Gyroscope not supported or denied.");
  }
}

gyroBtn.onclick=()=>{
  if(!gyroActive){ enableGyro(); }
  else{
    window.removeEventListener("deviceorientation", handleOrientation);
    gyroBtn.textContent="Enable Gyroscope";
    gyroActive=false;
  }
};

function handleOrientation(e){
  // gamma = left-right, beta = front-back
  const x = clamp(e.gamma / 30, -1, 1);
  const y = clamp(e.beta / 30, -1, 1);
  gravity.x = x;
  gravity.y = y;
}

function clamp(v,a,b){return Math.max(a,Math.min(b,v));}

// Start with some
for(let i=0;i<10;i++)spawnBall();
</script>
</body>
</html>
  ctx.scale(DPR, DPR);
}
resize();
window.addEventListener('resize', resize);

const balls = [];
let gravity = { x: 0, y: 0.5 }; // default gravity

class Ball {
  constructor(x, y, r, color) {
    this.x = x;
    this.y = y;
    this.r = r;
    this.vx = 0;
    this.vy = 0;
    this.color = color;
  }
  update() {
    this.vx += gravity.x;
    this.vy += gravity.y;
    this.vx *= 0.99;
    this.vy *= 0.99;
    this.x += this.vx;
    this.y += this.vy;
    if (this.x - this.r < 0) { this.x = this.r; this.vx *= -0.8; }
    if (this.x + this.r > canvas.clientWidth) { this.x = canvas.clientWidth - this.r; this.vx *= -0.8; }
    if (this.y - this.r < 0) { this.y = this.r; this.vy *= -0.8; }
    if (this.y + this.r > canvas.clientHeight) { this.y = canvas.clientHeight - this.r; this.vy *= -0.8; }
  }
  draw() {
    const g = ctx.createRadialGradient(this.x, this.y, this.r*0.3, this.x, this.y, this.r);
    g.addColorStop(0, "#fff");
    g.addColorStop(1, this.color);
    ctx.fillStyle = g;
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.r, 0, Math.PI*2);
    ctx.fill();
  }
}

function spawnBall() {
  const r = Math.random()*15+10;
  const x = Math.random()*(canvas.clientWidth-2*r)+r;
  const y = Math.random()*(canvas.clientHeight-2*r)+r;
  const color = ['#00f0ff','#ff3fd1','#8aff7a'][Math.floor(Math.random()*3)];
  balls.push(new Ball(x, y, r, color));
}

function loop() {
  ctx.fillStyle = "rgba(0,0,0,0.3)";
  ctx.fillRect(0,0,canvas.clientWidth,canvas.clientHeight);
  balls.forEach(b=>{b.update(); b.draw();});
  requestAnimationFrame(loop);
}
loop();

document.getElementById('addBall').onclick = ()=>{for(let i=0;i<5;i++)spawnBall();};
document.getElementById('clear').onclick = ()=>{balls.length=0;};

// ---- Gyroscope ----
let gyroEnabled = false;
const toggleBtn = document.getElementById('toggleGyro');
toggleBtn.onclick = async ()=>{
  if(!gyroEnabled){
    if (typeof DeviceOrientationEvent !== "undefined" && typeof DeviceOrientationEvent.requestPermission === "function") {
      try {
        const res = await DeviceOrientationEvent.requestPermission();
        if(res === "granted"){
          window.addEventListener("deviceorientation", handleOrientation);
          toggleBtn.textContent = "Disable Gyroscope";
          gyroEnabled = true;
        }
      } catch(e){ alert("Permission denied"); }
    } else {
      window.addEventListener("deviceorientation", handleOrientation);
      toggleBtn.textContent = "Disable Gyroscope";
      gyroEnabled = true;
    }
  } else {
    window.removeEventListener("deviceorientation", handleOrientation);
    toggleBtn.textContent = "Enable Gyroscope";
    gyroEnabled = false;
  }
};

function handleOrientation(e){
  // e.beta = front-back tilt, e.gamma = left-right tilt
  const x = clamp(e.gamma / 45, -1, 1);
  const y = clamp(e.beta / 45, -1, 1);
  gravity.x = x;
  gravity.y = y;
}

function clamp(v,a,b){ return Math.max(a, Math.min(b,v)); }

// start with some balls
for(let i=0;i<10;i++) spawnBall();
</script>
</body>
</html>
